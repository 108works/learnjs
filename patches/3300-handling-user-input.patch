From e653fa2f47a6a3cc2e1e66b1cedf1c25248af1a1 Mon Sep 17 00:00:00 2001
From: Ben Rady <benrady@gmail.com>
Date: Thu, 7 May 2015 21:22:32 -0500
Subject: [PATCH 1012/1031] handling user input

---
 public/app.js            | 23 ++++++++++++++++++++---
 public/index.html        |  9 +++++++++
 public/tests/app_spec.js | 16 ++++++++++++++++
 3 files changed, 45 insertions(+), 3 deletions(-)

diff --git a/public/app.js b/public/app.js
index fbf3576..adbc8d3 100644
--- a/public/app.js
+++ b/public/app.js
@@ -27,10 +27,27 @@ learnjs.applyObject = function(obj, elem) {
 learnjs.problemView = function(data) {
   var problemNumber = parseInt(data, 10);
   var view = $('.templates .problem-view').clone();
+  var problemData = learnjs.problems[problemNumber - 1]; //<label id="code.problemData"/>
+  var resultFlash = view.find('.result'); //<label id="code.resultFlash"/>
+
+  function checkAnswer() { //<label id="code.checkAnswer"/>
+    var answer = view.find('.answer').val();
+    var test = problemData.code.replace('__', answer) + '; problem();';
+    return eval(test);
+  }
+
+  function checkAnswerClick() { //<label id="code.checkAnswerClick"/>
+    if (checkAnswer()) {
+      resultFlash.text('Correct!');
+    } else {
+      resultFlash.text('Incorrect!');
+    }
+    return false;
+  }
+
+  view.find('.check-btn').click(checkAnswerClick); //<label id="code.clickBind"/>
   view.find('.title').text('Problem #' + problemNumber);
-  // START_HIGHLIGHT
-  learnjs.applyObject(learnjs.problems[problemNumber - 1], view);
-  // END_HIGHLIGHT
+  learnjs.applyObject(problemData, view);
   return view;
 }
 // END: problemView
diff --git a/public/index.html b/public/index.html
index ff36357..71c4193 100644
--- a/public/index.html
+++ b/public/index.html
@@ -40,6 +40,15 @@
           <h3 class='title'></h3>
           <p data-name='description'></p>
           <pre><code data-name='code'></code></pre>
+          <!-- START_HIGHLIGHT -->
+          <form>
+            <textarea class='u-full-width answer'></textarea>
+            <div>
+              <button class='button-primary check-btn'>Check Answer</button>
+              <p class='result'></p>
+            </div>
+          </form>
+          <!-- END_HIGHLIGHT -->
         </div>
       </div>
       <!-- END: problemView -->
diff --git a/public/tests/app_spec.js b/public/tests/app_spec.js
index 1fff438..dd22d48 100644
--- a/public/tests/app_spec.js
+++ b/public/tests/app_spec.js
@@ -54,6 +54,22 @@ describe('LearnJS', function() {
     it('shows the problem code', function() {
       expect(view.find('[data-name="code"]').text()).toEqual('function problem() { return __; }');
     });
+
+    // START: problemViewAnswers
+    describe('answer section', function() {
+      it('can check a correct answer by hitting a button', function() {
+        view.find('.answer').val('true');
+        view.find('.check-btn').click();
+        expect(view.find('.result').text()).toEqual('Correct!');
+      });
+
+      it('rejects an incorrect answer', function() {
+        view.find('.answer').val('false');
+        view.find('.check-btn').click();
+        expect(view.find('.result').text()).toEqual('Incorrect!');
+      });
+    });
+    // END: problemViewAnswers
   });
   // END: problemView
 });
-- 
2.3.8 (Apple Git-58)

